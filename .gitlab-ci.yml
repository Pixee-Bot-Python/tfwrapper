variables:
  POETRY_VERSION: 1.1.8
  TOX_VERSION: 3.24.3

stages:
  - lint
  - unit-test

image: python:${PYTHON_VERSION}

lint:
  stage: lint
  image: python:3
  script:
    - pip install poetry==${POETRY_VERSION} tox==${TOX_VERSION}
    - tox -e lint

tox:
  stage: unit-test
  parallel:
    matrix:
      - PYTHON_VERSION: ["3.6", "3.7", "3.8", "3.9"]
  script:
    - pip install poetry==${POETRY_VERSION} tox==${TOX_VERSION}
    - tox -e py
